const data = {
    accepted_currencies: [],
    investor_terms: {
        min_amount: 454,
        user_share: 0.11111,
    },
    investor_stages: [],
    lender_stages: [],
    packages: [],
    documents: [
        {
            id: 16,
            title: 'sdfsdf',
            isHidden: false,
            category: null,
            project: null,
            file: {
                id: 173,
                name: 'Снимок экрана 2022-04-18 в 21.25.39.png',
                alternativeText: null,
                caption: null,
                width: 1708,
                height: 702,
                formats: {
                    large: {
                        ext: '.png',
                        url: '/uploads/large_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf.png',
                        hash: 'large_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf',
                        mime: 'image/png',
                        name: 'large_Снимок экрана 2022-04-18 в 21.25.39.png',
                        path: null,
                        size: 197.6,
                        width: 1000,
                        height: 411,
                    },
                    small: {
                        ext: '.png',
                        url: '/uploads/small_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf.png',
                        hash: 'small_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf',
                        mime: 'image/png',
                        name: 'small_Снимок экрана 2022-04-18 в 21.25.39.png',
                        path: null,
                        size: 64.65,
                        width: 500,
                        height: 206,
                    },
                    medium: {
                        ext: '.png',
                        url: '/uploads/medium_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf.png',
                        hash: 'medium_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf',
                        mime: 'image/png',
                        name: 'medium_Снимок экрана 2022-04-18 в 21.25.39.png',
                        path: null,
                        size: 123.73,
                        width: 750,
                        height: 308,
                    },
                    thumbnail: {
                        ext: '.png',
                        url: '/uploads/thumbnail_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf.png',
                        hash: 'thumbnail_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf',
                        mime: 'image/png',
                        name: 'thumbnail_Снимок экрана 2022-04-18 в 21.25.39.png',
                        path: null,
                        size: 20.9,
                        width: 245,
                        height: 101,
                    },
                },
                hash: 'Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf',
                ext: '.png',
                mime: 'image/png',
                size: 87.81,
                url: '/uploads/Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf.png',
                previewUrl: null,
                provider: 'local',
                providerMetadata: null,
                createdAt: '2022-04-25T18:24:27.158Z',
                updatedAt: '2022-04-25T18:24:27.158Z',
            },
            cover: null,
        },
    ],
    title: '345345',
    description: '345345345',
    type: 'open',
    category: 1,
    status: 'active',
    starts_at: '',
    ends_at: '',
    fundraising_amount: 234345,
    initial_units: 34534,
    initial_unit_cost: 3430,
    roi: 455,
    fundraising_starts_at: '',
    fundraising_ends_at: '',
    funds_management_fee: 3,
    max_drawdown: 45,
    deposit_timing: 3,
    withdraw_delay: 4,
    auto_compound: false,
    special_terms: '',
    installments_enabled: false,
    publishedAt: 1650961793484,
};

const files = {
    covers: [
        {
            id: 174,
            name: 'Снимок экрана 2022-04-18 в 21.25.39.png',
            alternativeText: null,
            caption: null,
            width: 1708,
            height: 702,
            formats: {
                large: {
                    ext: '.png',
                    url: '/uploads/large_Snimok_ekrana_2022_04_18_v_21_25_39_2af21d6885.png',
                    hash: 'large_Snimok_ekrana_2022_04_18_v_21_25_39_2af21d6885',
                    mime: 'image/png',
                    name: 'large_Снимок экрана 2022-04-18 в 21.25.39.png',
                    path: null,
                    size: 197.6,
                    width: 1000,
                    height: 411,
                },
                small: {
                    ext: '.png',
                    url: '/uploads/small_Snimok_ekrana_2022_04_18_v_21_25_39_2af21d6885.png',
                    hash: 'small_Snimok_ekrana_2022_04_18_v_21_25_39_2af21d6885',
                    mime: 'image/png',
                    name: 'small_Снимок экрана 2022-04-18 в 21.25.39.png',
                    path: null,
                    size: 64.65,
                    width: 500,
                    height: 206,
                },
                medium: {
                    ext: '.png',
                    url: '/uploads/medium_Snimok_ekrana_2022_04_18_v_21_25_39_2af21d6885.png',
                    hash: 'medium_Snimok_ekrana_2022_04_18_v_21_25_39_2af21d6885',
                    mime: 'image/png',
                    name: 'medium_Снимок экрана 2022-04-18 в 21.25.39.png',
                    path: null,
                    size: 123.73,
                    width: 750,
                    height: 308,
                },
                thumbnail: {
                    ext: '.png',
                    url: '/uploads/thumbnail_Snimok_ekrana_2022_04_18_v_21_25_39_2af21d6885.png',
                    hash: 'thumbnail_Snimok_ekrana_2022_04_18_v_21_25_39_2af21d6885',
                    mime: 'image/png',
                    name: 'thumbnail_Снимок экрана 2022-04-18 в 21.25.39.png',
                    path: null,
                    size: 20.9,
                    width: 245,
                    height: 101,
                },
            },
            hash: 'Snimok_ekrana_2022_04_18_v_21_25_39_2af21d6885',
            ext: '.png',
            mime: 'image/png',
            size: 87.81,
            url: '/uploads/Snimok_ekrana_2022_04_18_v_21_25_39_2af21d6885.png',
            previewUrl: null,
            provider: 'local',
            providerMetadata: null,
            createdAt: '2022-04-25T19:29:15.553Z',
            updatedAt: '2022-04-25T19:29:15.553Z',
            related: [
                {
                    id: 130,
                    _Type: 'api::project.project',
                    title: '345345',
                    status: 'active',
                    type: 'open',
                    createdAt: '2022-04-25T17:55:50.670Z',
                    updatedAt: '2022-04-26T08:43:50.172Z',
                    publishedAt: '2022-04-26T08:42:17.361Z',
                    description: '345345345',
                    startsAt: null,
                    endsAt: null,
                    fundraisingAmount: 234345,
                    initialUnits: 34534,
                    initialUnitCost: 3430,
                    roi: 455,
                    fundraisingStartsAt: null,
                    fundraisingEndsAt: null,
                    fundsManagementFee: 3,
                    maxDrawdown: 45,
                    depositTiming: 3,
                    withdrawDelay: 4,
                    autoCompound: false,
                    specialTerms: null,
                    installmentsEnabled: false,
                },
            ],
        },
        {
            id: 175,
            name: 'Снимок экрана 2022-04-21 в 16.36.59.png',
            alternativeText: null,
            caption: null,
            width: 876,
            height: 804,
            formats: {
                small: {
                    ext: '.png',
                    url: '/uploads/small_Snimok_ekrana_2022_04_21_v_16_36_59_df8df61554.png',
                    hash: 'small_Snimok_ekrana_2022_04_21_v_16_36_59_df8df61554',
                    mime: 'image/png',
                    name: 'small_Снимок экрана 2022-04-21 в 16.36.59.png',
                    path: null,
                    size: 90.85,
                    width: 500,
                    height: 459,
                },
                medium: {
                    ext: '.png',
                    url: '/uploads/medium_Snimok_ekrana_2022_04_21_v_16_36_59_df8df61554.png',
                    hash: 'medium_Snimok_ekrana_2022_04_21_v_16_36_59_df8df61554',
                    mime: 'image/png',
                    name: 'medium_Снимок экрана 2022-04-21 в 16.36.59.png',
                    path: null,
                    size: 167.21,
                    width: 750,
                    height: 688,
                },
                thumbnail: {
                    ext: '.png',
                    url: '/uploads/thumbnail_Snimok_ekrana_2022_04_21_v_16_36_59_df8df61554.png',
                    hash: 'thumbnail_Snimok_ekrana_2022_04_21_v_16_36_59_df8df61554',
                    mime: 'image/png',
                    name: 'thumbnail_Снимок экрана 2022-04-21 в 16.36.59.png',
                    path: null,
                    size: 18.57,
                    width: 170,
                    height: 156,
                },
            },
            hash: 'Snimok_ekrana_2022_04_21_v_16_36_59_df8df61554',
            ext: '.png',
            mime: 'image/png',
            size: 30.7,
            url: '/uploads/Snimok_ekrana_2022_04_21_v_16_36_59_df8df61554.png',
            previewUrl: null,
            provider: 'local',
            providerMetadata: null,
            createdAt: '2022-04-25T19:29:15.552Z',
            updatedAt: '2022-04-25T19:29:15.552Z',
            related: [
                {
                    id: 130,
                    _Type: 'api::project.project',
                    title: '345345',
                    status: 'active',
                    type: 'open',
                    createdAt: '2022-04-25T17:55:50.670Z',
                    updatedAt: '2022-04-26T08:43:50.172Z',
                    publishedAt: '2022-04-26T08:42:17.361Z',
                    description: '345345345',
                    startsAt: null,
                    endsAt: null,
                    fundraisingAmount: 234345,
                    initialUnits: 34534,
                    initialUnitCost: 3430,
                    roi: 455,
                    fundraisingStartsAt: null,
                    fundraisingEndsAt: null,
                    fundsManagementFee: 3,
                    maxDrawdown: 45,
                    depositTiming: 3,
                    withdrawDelay: 4,
                    autoCompound: false,
                    specialTerms: null,
                    installmentsEnabled: false,
                },
            ],
        },
        {
            id: 176,
            name: 'Снимок экрана 2022-04-19 в 17.18.14.png',
            alternativeText: null,
            caption: null,
            width: 3360,
            height: 2052,
            formats: {
                large: {
                    ext: '.png',
                    url: '/uploads/large_Snimok_ekrana_2022_04_19_v_17_18_14_f4bc7594b1.png',
                    hash: 'large_Snimok_ekrana_2022_04_19_v_17_18_14_f4bc7594b1',
                    mime: 'image/png',
                    name: 'large_Снимок экрана 2022-04-19 в 17.18.14.png',
                    path: null,
                    size: 254.89,
                    width: 1000,
                    height: 611,
                },
                small: {
                    ext: '.png',
                    url: '/uploads/small_Snimok_ekrana_2022_04_19_v_17_18_14_f4bc7594b1.png',
                    hash: 'small_Snimok_ekrana_2022_04_19_v_17_18_14_f4bc7594b1',
                    mime: 'image/png',
                    name: 'small_Снимок экрана 2022-04-19 в 17.18.14.png',
                    path: null,
                    size: 90.77,
                    width: 500,
                    height: 305,
                },
                medium: {
                    ext: '.png',
                    url: '/uploads/medium_Snimok_ekrana_2022_04_19_v_17_18_14_f4bc7594b1.png',
                    hash: 'medium_Snimok_ekrana_2022_04_19_v_17_18_14_f4bc7594b1',
                    mime: 'image/png',
                    name: 'medium_Снимок экрана 2022-04-19 в 17.18.14.png',
                    path: null,
                    size: 166.17,
                    width: 750,
                    height: 458,
                },
                thumbnail: {
                    ext: '.png',
                    url: '/uploads/thumbnail_Snimok_ekrana_2022_04_19_v_17_18_14_f4bc7594b1.png',
                    hash: 'thumbnail_Snimok_ekrana_2022_04_19_v_17_18_14_f4bc7594b1',
                    mime: 'image/png',
                    name: 'thumbnail_Снимок экрана 2022-04-19 в 17.18.14.png',
                    path: null,
                    size: 30.52,
                    width: 245,
                    height: 150,
                },
            },
            hash: 'Snimok_ekrana_2022_04_19_v_17_18_14_f4bc7594b1',
            ext: '.png',
            mime: 'image/png',
            size: 222.05,
            url: '/uploads/Snimok_ekrana_2022_04_19_v_17_18_14_f4bc7594b1.png',
            previewUrl: null,
            provider: 'local',
            providerMetadata: null,
            createdAt: '2022-04-25T19:29:15.574Z',
            updatedAt: '2022-04-25T19:29:15.574Z',
            related: [
                {
                    id: 130,
                    _Type: 'api::project.project',
                    title: '345345',
                    status: 'active',
                    type: 'open',
                    createdAt: '2022-04-25T17:55:50.670Z',
                    updatedAt: '2022-04-26T08:43:50.172Z',
                    publishedAt: '2022-04-26T08:42:17.361Z',
                    description: '345345345',
                    startsAt: null,
                    endsAt: null,
                    fundraisingAmount: 234345,
                    initialUnits: 34534,
                    initialUnitCost: 3430,
                    roi: 455,
                    fundraisingStartsAt: null,
                    fundraisingEndsAt: null,
                    fundsManagementFee: 3,
                    maxDrawdown: 45,
                    depositTiming: 3,
                    withdrawDelay: 4,
                    autoCompound: false,
                    specialTerms: null,
                    installmentsEnabled: false,
                },
            ],
        },
    ],
    'documents[0].file': {
        id: 173,
        name: 'Снимок экрана 2022-04-18 в 21.25.39.png',
        alternativeText: null,
        caption: null,
        width: 1708,
        height: 702,
        formats: {
            large: {
                ext: '.png',
                url: '/uploads/large_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf.png',
                hash: 'large_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf',
                mime: 'image/png',
                name: 'large_Снимок экрана 2022-04-18 в 21.25.39.png',
                path: null,
                size: 197.6,
                width: 1000,
                height: 411,
            },
            small: {
                ext: '.png',
                url: '/uploads/small_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf.png',
                hash: 'small_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf',
                mime: 'image/png',
                name: 'small_Снимок экрана 2022-04-18 в 21.25.39.png',
                path: null,
                size: 64.65,
                width: 500,
                height: 206,
            },
            medium: {
                ext: '.png',
                url: '/uploads/medium_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf.png',
                hash: 'medium_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf',
                mime: 'image/png',
                name: 'medium_Снимок экрана 2022-04-18 в 21.25.39.png',
                path: null,
                size: 123.73,
                width: 750,
                height: 308,
            },
            thumbnail: {
                ext: '.png',
                url: '/uploads/thumbnail_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf.png',
                hash: 'thumbnail_Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf',
                mime: 'image/png',
                name: 'thumbnail_Снимок экрана 2022-04-18 в 21.25.39.png',
                path: null,
                size: 20.9,
                width: 245,
                height: 101,
            },
        },
        hash: 'Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf',
        ext: '.png',
        mime: 'image/png',
        size: 87.81,
        url: '/uploads/Snimok_ekrana_2022_04_18_v_21_25_39_e70096cabf.png',
        previewUrl: null,
        provider: 'local',
        providerMetadata: null,
        createdAt: '2022-04-25T18:24:27.158Z',
        updatedAt: '2022-04-25T18:24:27.158Z',
    },
};

const removeFilesKeysFromData = ({ data, files, dataKey, index }) => {
    data;
    files;
    dataKey;

    let modified = {};
    for (const key in data) {
        key;
        data[key];
        if (typeof data[key] !== 'object' || data[key] === null) {
            data[key];
            modified[key] = data[key];
        }
        // console.log(`🚀 ~ removeFilesKeysFromData ~ data`, data, files);
        if (Array.isArray(data[key])) {
            key;
            modified[key] = data[key].map((item, index) =>
                removeFilesKeysFromData({ data: item, files, dataKey: `${key}[${index}]`, index })
            );
            if (modified[key].length && modified[key][0]?.ext) {
                delete modified[key];
            }
            console.log(`🚀 ~ removeFilesKeysFromData ~ data[key]`, key, data[key], files);
        }
        if (typeof data[key] === 'object') {
            if (dataKey) {
                dataKey;
                key;
                `${dataKey}${key}`;
                // stages[0].icon;
                if (Object.keys(files).includes(`${dataKey}.${key}`)) {
                    Object.keys(files);
                    delete modified[key];
                }
                Object.keys(files);
            }
            if (data[key]?.ext) {
                delete modified[key];
            }
            modified[key];
            // .includes(`${dataKey}${key}`);
        }
    }
    // console.log(`🚀 ~ removeFilesKeysFromData ~ data, files`, data, files);
    return modified;
};

const clearFields = ({ data, dataKey, files }) => {
    let modified;
    dataKey;
    if (typeof data === 'object') {
        modified = {};
        if (Array.isArray(data)) {
            modified = [];
            dataKey;
            files;
            for (const [index, element] of data.entries()) {
                element;
                index;
                `${dataKey}[${index}]`;
                modified.push(clearFields({ data: element, files }));
            }
        } else {
            let isFile = Object.keys(data).filter((key) => {
                data[key]; //?
            });
            for (const key of Object.keys(data)) {
                key;
                if (data[key] === '' || data[key] === null) {
                    continue;
                }
                data[key];
                // если это не файл
                if (!data[key]?.ext) {
                    modified[key] = clearFields({ data: data[key], dataKey: key, files });
                }
            }
        }
    } else {
        modified = data;
    }
    return modified;
};

const res = clearFields({ data, files });
